---
- name: "allow"
  description: "Let these packets go through."
- name: "ClearRecordTypes"
  description: "Removes given type(s) records from the response. Beware you can accidentally turn the answer into a NODATA response without a SOA record in the additional section in which case you may want to use NegativeAndSOAAction() to generate an answer, see example below. Subsequent rules are processed after this action."
  skip-cpp: true
  skip-rust: true
  parameters:
    - name: "types"
      type: "Vec<u16>"
      default: true
      description: "List of types to remove"
- name: "delay"
  description: "Delay the response by the specified amount of milliseconds (UDP-only). Note that the sending of the query to the backend, if needed, is not delayed. Only the sending of the response to the client will be delayed. Subsequent rules are processed after this action"
  parameters:
    - name: "msec"
      type: "u32"
- name: "DnstapLog"
  description: "Send the current response to a remote logger as a dnstap message. ``alter-function`` is a callback, receiving a :class:`DNSResponse` and a :class:`DnstapMessage`, that can be used to modify the message. Subsequent rules are processed after this action"
  skip-cpp: true
  skip-rust: true
  parameters:
    - name: "identity"
      type: "String"
    - name: "logger-name"
      type: "String"
    - name: "alter-function_name"
      type: "String"
      default: ""
    - name: "alter-function-code"
      type: "String"
      default: ""
    - name: "alter-function-file"
      type: "String"
      default: ""
- name: "drop"
  description: "Drop the packet"
- name: "LimitTTL"
  description: "Cap the TTLs of the response to the given boundaries"
  skip-cpp: true
  skip-rust: true
  parameters:
    - name: "min"
      type: "u32"
    - name: "max"
      type: "u32"
    - name: "types"
      type: "Vec<u16>"
      default: true
- name: "log"
  description: "Log a line for each response, to the specified file if any, to the console (require verbose) if the empty string is given as filename.
If an empty string is supplied in the file name, the logging is done to stdout, and only in verbose mode by default. This can be changed by setting ``verbose-only`` to ``false``.
When logging to a file, the ``binary`` parameter specifies whether we log in binary form (default) or in textual form. The ``append`` parameter specifies whether we open the file for appending or truncate each time (default). The ``buffered`` parameter specifies whether writes to the file are buffered (default) or not.
Subsequent rules are processed after this action"
  parameters:
    - name: "file-name"
      type: "String"
      default: ""
      cpp-optional: false
    - name: "append"
      type: "bool"
      default: "false"
      cpp-optional: false
    - name: "buffered"
      type: "bool"
      default: "false"
      cpp-optional: false
    - name: "verbose-only"
      type: "bool"
      default: "true"
      cpp-optional: false
    - name: "include-timestamp"
      type: "bool"
      default: "false"
      cpp-optional: false
- name: "lua"
  description: "Invoke a Lua function that accepts a :class:`DNSResponse`. The function should return a :ref:`DNSResponseAction`. If the Lua code fails, ``ServFail`` is returned"
  skip-cpp: true
  skip-rust: true
  parameters:
    - name: "function-name"
      type: "String"
      default: ""
    - name: "function-code"
      type: "String"
      default: ""
    - name: "function-file"
      type: "String"
      default: ""
- name: "LuaFFI"
  description: "Invoke a Lua function that accepts a pointer to a ``dnsdist_ffi_dnsquestion_t`` object, whose bindings are defined in ``dnsdist-lua-ffi-interface.h``. The function should return a :ref:`DNSResponseAction`. If the Lua code fails, ``ServFail`` is returned"
  skip-cpp: true
  skip-rust: true
  parameters:
    - name: "function-name"
      type: "String"
      default: ""
    - name: "function-code"
      type: "String"
      default: ""
    - name: "function-file"
      type: "String"
      default: ""
- name: "LuaFFIPerThread"
  description: "Invoke a Lua function that accepts a pointer to a ``dnsdist_ffi_dnsquestion_t`` object, whose bindings are defined in ``dnsdist-lua-ffi-interface.h``. The function should return a :ref:`DNSResponseAction`. If the Lua code fails, ``ServFail`` is returned.
The function will be invoked in a per-thread Lua state, without access to the global Lua state. All constants (:ref:`DNSQType`, :ref:`DNSRCode`, ...) are available in that per-thread context, as well as all FFI functions. Objects and their bindings that are not usable in a FFI context (:class:`DNSQuestion`, :class:`DNSDistProtoBufMessage`, :class:`PacketCache`, ...) are not available."
  parameters:
    - name: "code"
      type: "String"
- name: "RemoteLog"
  description: "Send the current response to a remote logger as a Protocol Buffer message. ``alter-function`` is a callback, receiving a :class:`DNSResponse` and a :class:`DNSDistProtoBufMessage`, that can be used to modify the message, for example for anonymization purposes. Subsequent rules are processed after this action"
  skip-cpp: true
  skip-rust: true
  parameters:
    - name: "logger-name"
      type: "String"
    - name: "alter-function-name"
      type: "String"
      default: ""
    - name: "alter-function-code"
      type: "String"
      default: ""
    - name: "alter-function-file"
      type: "String"
      default: ""
    - name: "server-id"
      type: "String"
      default: ""
    - name: "ip-encrypt-key"
      type: "String"
      default: ""
    - name: "include-cname"
      type: "bool"
      default: "false"
    - name: "export-tags"
      type: "Vec<String>"
      default: true
    - name: "export-extended-errors-to-meta"
      type: "String"
      default: ""
    - name: "metas"
      type: "Vec<ProtoBufMetaConfiguration>"
      default: true
- name: "SetExtendedDNSError"
  description: "Set an Extended DNS Error status that will be added to the response. Subsequent rules are processed after this action"
  parameters:
    - name: "info-code"
      type: "u16"
    - name: "extra-text"
      type: "String"
      default: ""
      cpp-optional: false
- name: "SetMaxReturnedTTL"
  description: "Cap the TTLs of the response to the given maximum, but only after inserting the response into the packet cache with the initial TTL values"
  skip-cpp: true
  parameters:
    - name: "max"
      type: "u32"
- name: "SetMaxTTL"
  description: "Cap the TTLs of the response to the given maximum"
  skip-cpp: true
  skip-rust: true
  parameters:
    - name: "max"
      type: "u32"
- name: "SetMinTTL"
  description: "Cap the TTLs of the response to the given minimum"
  skip-cpp: true
  skip-rust: true
  parameters:
    - name: "min"
      type: "u32"
- name: "SetReducedTTL"
  description: "Reduce the TTL of records in a response to a percentage of the original TTL. For example, passing 50 means that the original TTL will be cut in half. Subsequent rules are processed after this action"
  parameters:
    - name: "percentage"
      type: "u8"
- name: "SetSkipCache"
  description: "Donâ€™t store this answer in the cache. Subsequent rules are processed after this action."
- name: "SetTag"
  description: "Associate a tag named ``tag`` with a value of ``value`` to this response. This function will overwrite any existing tag value. Subsequent rules are processed after this action"
  parameters:
    - name: "tag"
      type: "String"
    - name: "value"
      type: "String"
- name: "SNMPTrap"
  description: "Send an SNMP trap, adding the message string as the query description. Subsequent rules are processed after this action"
  parameters:
    - name: "reason"
      type: "String"
      default: ""
      cpp-optional: false
- name: "TC"
  description: "Truncate an existing answer, to force the client to TCP. Only applied to answers that will be sent to the client over TCP. In addition to the TC bit being set, all records are removed from the answer, authority and additional sections"
