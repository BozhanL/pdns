.. THIS IS A GENERATED FILE. DO NOT EDIT. See dnsdist-settings-documentation-generator.py

.. raw:: latex

    \setcounter{secnumdepth}{-1}

YAML configuration reference
============================

Since 2.0.0, :program:`dnsdist` supports the YAML configuration format in addition to the existing Lua one.

If the configuration file passed to :program:`dnsdist` via the ``-C`` command-line switch ends in ``.yml``, it is assumed to be in the new YAML format, and an attempt to load a Lua configuration file with the same name but the ``.lua`` will be done before loading the YAML configuration. If the names ends in ``.lua``, there will also be an attempt to find a file with the same name but ending in ``.yml``. Otherwise the existing Lua configuration format is assumed.

A YAML configuration file contains several sections, that are described below.

.. code-block:: yaml

.. _yaml-settings-GlobalConfiguration:

GlobalConfiguration
-------------------

- **acl**: Sequence of String ``(127.0.0.0/8, 10.0.0.0/8, 100.64.0.0/10, 169.254.0.0/16, 192.168.0.0/16, 172.16.0.0/12, ::1/128, fc00::/7, fe80::/10)`` - CIDR netmasks of the clients allowed to send DNS queries
- **backends**: Sequence of :ref:`BackendConfiguration <yaml-settings-BackendConfiguration>` - List of backends
- **binds**: Sequence of :ref:`BindConfiguration <yaml-settings-BindConfiguration>` - List of endpoints to accept queries on
- **cache_hit_response_rules**: Sequence of :ref:`ResponseRuleConfiguration <yaml-settings-ResponseRuleConfiguration>` - List of rules executed on a cache hit
- **cache_inserted_response_rules**: Sequence of :ref:`ResponseRuleConfiguration <yaml-settings-ResponseRuleConfiguration>` - List of rules executed after inserting a new response into the cache
- **cache_miss_rules**: Sequence of :ref:`QueryRuleConfiguration <yaml-settings-QueryRuleConfiguration>` - List of rules executed after a cache miss
- **cache_settings**: :ref:`CacheSettingsConfiguration <yaml-settings-CacheSettingsConfiguration>` - Caching-related settings
- **console**: :ref:`ConsoleConfiguration <yaml-settings-ConsoleConfiguration>` - Console-related settings
- **dynamic_rules**: Sequence of :ref:`DynamicRulesConfiguration <yaml-settings-DynamicRulesConfiguration>` - List of dynamic rules
- **dynamic_rules_settings**: :ref:`DynamicRulesSettingsConfiguration <yaml-settings-DynamicRulesSettingsConfiguration>` - Dynamic rules-related settings
- **ebpf**: :ref:`EbpfConfiguration <yaml-settings-EbpfConfiguration>` - EBPF settings
- **edns_client_subnet**: :ref:`EdnsClientSubnetConfiguration <yaml-settings-EdnsClientSubnetConfiguration>` - EDNS Client Subnet-related settings
- **general**: :ref:`GeneralConfiguration <yaml-settings-GeneralConfiguration>` - General settings
- **key_value_stores**: :ref:`KeyValueStoresConfiguration <yaml-settings-KeyValueStoresConfiguration>` - Key-Value stores
- **load_balancing_policies**: :ref:`LoadBalancingPoliciesConfiguration <yaml-settings-LoadBalancingPoliciesConfiguration>` - Load-balancing policies
- **metrics**: :ref:`MetricsConfiguration <yaml-settings-MetricsConfiguration>` - Metrics-related settings
- **packet_caches**: Sequence of :ref:`PacketCacheConfiguration <yaml-settings-PacketCacheConfiguration>` - Packet-cache definitions
- **pools**: Sequence of :ref:`PoolConfiguration <yaml-settings-PoolConfiguration>` - Pools of backends
- **proxy_protocol**: :ref:`ProxyProtocolConfiguration <yaml-settings-ProxyProtocolConfiguration>` - Proxy-protocol-related settings
- **query_count**: :ref:`QueryCountConfiguration <yaml-settings-QueryCountConfiguration>` - Queries counting-related settings
- **query_rules**: Sequence of :ref:`QueryRuleConfiguration <yaml-settings-QueryRuleConfiguration>` - List of rules executed when a query is received
- **remote_logging**: :ref:`RemoteLoggingConfiguration <yaml-settings-RemoteLoggingConfiguration>` - Remote logging-related settings
- **response_rules**: Sequence of :ref:`ResponseRuleConfiguration <yaml-settings-ResponseRuleConfiguration>` - List of rules executed when a response is received
- **ring_buffers**: :ref:`RingBuffersConfiguration <yaml-settings-RingBuffersConfiguration>` - In-memory ring buffer settings
- **security_polling**: :ref:`SecurityPollingConfiguration <yaml-settings-SecurityPollingConfiguration>` - Automatic checking of outdated version
- **selectors**: Sequence of :ref:`Selector <yaml-settings-Selector>` - List of selectors that can be reused in rules
- **self_answered_response_rules**: Sequence of :ref:`ResponseRuleConfiguration <yaml-settings-ResponseRuleConfiguration>` - List of rules executed when a response is generated by DNSdist itself
- **snmp**: :ref:`SnmpConfiguration <yaml-settings-SnmpConfiguration>` - SNMP-related settings
- **tuning**: :ref:`TuningConfiguration <yaml-settings-TuningConfiguration>` - Performance-related settings
- **webserver**: :ref:`WebserverConfiguration <yaml-settings-WebserverConfiguration>` - Internal web server configuration
- **xfr_response_rules**: Sequence of :ref:`ResponseRuleConfiguration <yaml-settings-ResponseRuleConfiguration>` - List of rules executed when a XFR response is received
- **xsk**: Sequence of :ref:`XskConfiguration <yaml-settings-XskConfiguration>` - List of AF_XDP / XSK objects



.. _yaml-settings-BackendConfiguration:

BackendConfiguration
--------------------

- **address**: String
- **id**: String ``("")``
- **name**: String ``("")``
- **protocol**: String
- **tls**: :ref:`OutgoingTlsConfiguration <yaml-settings-OutgoingTlsConfiguration>`
- **doh**: :ref:`OutgoingDohConfiguration <yaml-settings-OutgoingDohConfiguration>`
- **use_client_subnet**: Boolean ``(false)``
- **use_proxy_protocol**: Boolean ``(false)``
- **queries_per_second**: Unsigned integer ``(0)``
- **order**: Unsigned integer ``(1)``
- **weight**: Unsigned integer ``(1)``
- **pools**: Sequence of String
- **retries**: Unsigned integer ``(5)``
- **tcp**: :ref:`OutgoingTcpConfiguration <yaml-settings-OutgoingTcpConfiguration>`
- **ip_bind_addr_no_port**: Boolean ``(true)``
- **health_checks**: :ref:`HealthCheckConfiguration <yaml-settings-HealthCheckConfiguration>`
- **source**: String ``("")``
- **sockets**: Unsigned integer ``(1)``
- **disable_zero_scope**: Boolean ``(false)``
- **reconnect_on_up**: Boolean ``(false)``
- **max_in_flight**: Unsigned integer ``(1)``
- **tcp_only**: Boolean ``(false)``
- **auto_upgrade**: :ref:`OutgoingAutoUpgradeConfiguration <yaml-settings-OutgoingAutoUpgradeConfiguration>`
- **max_concurrent_tcp_connections**: Unsigned integer ``(0)``
- **ktls**: Boolean ``(false)``
- **proxy_protocol_advertise_tls**: Boolean ``(false)``
- **xsk_sockets**: Sequence of String
- **mac_address**: String ``("")``
- **cpus**: String ``("")``
- **xsk**: String ``("")``


.. _yaml-settings-BindConfiguration:

BindConfiguration
-----------------

- **listen_address**: String - Address and port to listen to
- **reuseport**: Boolean ``(false)``
- **protocol**: String ``(Do53)``
- **threads**: Unsigned integer ``(1)``
- **interface**: String ``("")``
- **cpus**: String ``("")``
- **enable_proxy_protocol**: Boolean ``(false)``
- **tcp**: :ref:`IncomingTcpConfiguration <yaml-settings-IncomingTcpConfiguration>`
- **tls**: :ref:`IncomingTlsConfiguration <yaml-settings-IncomingTlsConfiguration>`
- **doh**: :ref:`IncomingDohConfiguration <yaml-settings-IncomingDohConfiguration>`
- **doq**: :ref:`IncomingDoqConfiguration <yaml-settings-IncomingDoqConfiguration>`
- **quic**: :ref:`IncomingQuicConfiguration <yaml-settings-IncomingQuicConfiguration>`
- **dnscrypt**: :ref:`IncomingDnscryptConfiguration <yaml-settings-IncomingDnscryptConfiguration>`
- **additional_addresses**: Sequence of String
- **xsk**: String ``("")``


.. _yaml-settings-CDBKVStoreConfiguration:

CDBKVStoreConfiguration
-----------------------

CDB-based key-value store

- **name**: String - The name of this object
- **file_name**: String - The path to an existing CDB database
- **refresh_delay**: Unsigned integer - The delay in seconds between two checks of the database modification time. 0 means disabled


.. _yaml-settings-Cache_settingsConfiguration:

Cache_settingsConfiguration
---------------------------

- **stale_entries_ttl**: Unsigned integer ``(0)``
- **cleaning_delay**: Unsigned integer ``(60)``
- **cleaning_percentage**: Unsigned integer ``(100)``


.. _yaml-settings-CarbonConfiguration:

CarbonConfiguration
-------------------

Carbon endpoint to send metrics to

- **address**: String - Indicates the IP address where the statistics should be sent
- **name**: String ``("")`` - An optional string specifying the hostname that should be used. If left empty, the system hostname is used
- **interval**: Unsigned integer ``(30)`` - An optional unsigned integer indicating the interval in seconds between exports
- **namespace**: String ``("")`` - An optional string specifying the namespace name that should be used
- **instance**: String ``("")`` - An optional string specifying the instance name that should be used


.. _yaml-settings-ConsoleConfiguration:

ConsoleConfiguration
--------------------

Console-related settings

- **listen_address**: String ``("")`` - IP address and port to listen on for console connections
- **key**: String ``("")`` - The shared secret used to secure connections between the console client and the server, generated via ``makeKey()``
- **acl**: Sequence of String ``(127.0.0.1, ::1)`` - List of network masks or IP addresses that are allowed to open a connection to the console server
- **maximum_output_size**: Unsigned integer ``(10000000)`` - Set the maximum size, in bytes, of a single console message
- **log_connections**: Boolean ``(true)`` - Whether to log the opening and closing of console connections
- **max_concurrent_connections**: Unsigned integer ``(0)`` - Set the maximum number of concurrent console connection


.. _yaml-settings-Custom_load_balancing_policyConfiguration:

Custom_load_balancing_policyConfiguration
-----------------------------------------

- **name**: String
- **function_name**: String ``("")``
- **function_code**: String ``("")``
- **function_file**: String ``("")``
- **ffi**: Boolean ``(false)``
- **per_thread**: Boolean ``(false)``


.. _yaml-settings-Dnstap_loggerConfiguration:

Dnstap_loggerConfiguration
--------------------------

Endpoint to send queries and/or responses data to, using the dnstap format

- **name**: String - Name of this endpoint
- **transport**: String - The dnstap transport to use. Supported values are: unix, tcp
- **address**: String - The address of the endpoint. If the transport is set to 'unix', the address should be local ``AF_UNIX`` socket path. Note that most platforms have a rather short limit on the length. Otherwise the address should be an IP:port
- **buffer_hint**: Unsigned integer ``(0)`` - The threshold number of bytes to accumulate in the output buffer before forcing a buffer flush. According to the libfstrm library, the minimum is 1024, the maximum is 65536, and the default is 8192
- **flush_timeout**: Unsigned integer ``(0)`` - The number of seconds to allow unflushed data to remain in the output buffer. According to the libfstrm library, the minimum is 1 second, the maximum is 600 seconds (10 minutes), and the default is 1 second
- **input_queue_size**: Unsigned integer ``(0)`` - The number of queue entries to allocate for each input queue. This value must be a power of 2. According to the fstrm library, the minimum is 2, the maximum is 16384, and the default is 512
- **output_queue_size**: Unsigned integer ``(0)`` - The number of queue entries to allocate for each output queue. According to the libfstrm library, the minimum is 2, the maximum is system-dependent and based on ``IOV_MAX``, and the default is 64
- **queue_notify_threshold**: Unsigned integer ``(0)`` - The number of outstanding queue entries to allow on an input queue before waking the I/O thread. Accordingg to the libfstrm library, the minimum is 1 and the default is 32
- **reopen_interval**: Unsigned integer ``(0)`` - The number of queue entries to allocate for each output queue. According to the libfstrm library, the minimum is 2, the maximum is system-dependent and based on IOV_MAX, and the default is 64


.. _yaml-settings-Doh_tuningConfiguration:

Doh_tuningConfiguration
-----------------------

- **outgoing_worker_threads**: Unsigned integer ``(10)``
- **outgoing_max_idle_time**: Unsigned integer ``(300)``
- **outgoing_cleanup_interval**: Unsigned integer ``(60)``
- **outgoing_max_idle_connection_per_backend**: Unsigned integer ``(10)``


.. _yaml-settings-Dynamic_ruleConfiguration:

Dynamic_ruleConfiguration
-------------------------

Dynamic rule settings

- **type**: String - The type of this rule. Supported values are: query-rate, rcode-rate, rcode-ratio, qtype-rate, cache-miss-ratio, response-byte-rate
- **seconds**: Unsigned integer - Number of seconds the rule has been exceeded
- **action_duration**: Unsigned integer - How long the action is going to be enforced
- **comment**: String - Comment describing why the action why taken
- **rate**: Unsigned integer ``(0)`` - For ``query-rate``, ``rcode-rate``, ``qtype-rate`` and ``response-byte-rate``, the rate that should be exceeded
- **ratio**: Double ``(0.0)`` - For ``rcode-ratio``, ``qtype-ratio`` and ``cache-miss-ratio``, the ratio that should be exceeded
- **action**: String ``(drop)`` - The action that will be taken once the rate or ratio is exceeded. Supported values are: Drop, NoNop, NoRecurse, NXDomain, SetTag, Truncate, Refused
- **warning_rate**: Unsigned integer ``(0)`` - For ``query-rate``, ``rcode-rate``, ``qtype-rate`` and ``response-byte-rate``, the rate that should be exceeded for a warning to be logged, but no action enforced
- **warning_ratio**: Double ``(0.0)`` - For ``rcode-ratio`` and ``cache-miss-ratio``, the ratio that should be exceeded for a warning to be logged, but no action enforced
- **tag_name**: String ``("")``
- **tag_value**: String ``(0)`` - If ``action`` is set to ``SetTag``, the value that will be set
- **visitor_function_name**: String ``("")`` - For ``suffix-match`` and ``suffix-match-ffi``, the name of the Lua visitor function to call for each label of every domain seen in recent queries and responses
- **visitor_function_code**: String ``("")`` - For ``suffix-match`` and ``suffix-match-ffi``, the code of Lua visitor function for each label of every domain seen in recent queries and responses
- **visitor_function_file**: String ``("")`` - For ``suffix-match`` and ``suffix-match-ffi``, a path to a file containing the code of Lua visitor function for each label of every domain seen in recent queries and responses
- **rcode**: String ``("")`` - For ``rcode-rate`` and ``rcode-ratio``, the response code to match
- **qtype**: String ``("")`` - For ``qtype-rate``, the query type to match
- **minimum_number_of_responses**: Unsigned integer ``(0)`` - For ``cache-miss-ratio`` and ``rcode-ratio``, the minimum number of responses to have received for this rule to apply
- **minimum_global_cache_hit_ratio**: Double ``(0.0)`` - The minimum global cache-hit ratio (over all pools, so ``cache-hits`` / (``cache-hits`` + ``cache-misses``)) for a ``cache-miss-ratio`` rule to be applied


.. _yaml-settings-Dynamic_rulesConfiguration:

Dynamic_rulesConfiguration
--------------------------

Group of dynamic rules

- **name**: String - The name of this group of dynamic rules
- **mask_ipv4**: Unsigned integer ``(32)`` - Number of bits to keep for IPv4 addresses
- **mask_ipv6**: Unsigned integer ``(64)`` - Number of bits to keep for IPv6 addresses. In some scenarios it might make sense to block a whole /64 IPv6 range instead of a single address, for example
- **mask_port**: Unsigned integer ``(0)`` - Number of bits of port to consider over IPv4, for CGNAT deployments. Default is 0 meaning that the port is not taken into account. For example passing ``2`` here, which only makes sense if the IPv4 parameter is set to ``32``, will split a given IPv4 address into four port ranges: ``0-16383``, ``16384-32767``, ``32768-49151`` and ``49152-65535``
- **exclude_ranges**: Sequence of String - Exclude this list of ranges, meaning that no dynamic block will ever be inserted for clients in that range. Default to empty, meaning rules are applied to all ranges. When used in combination with ``include_ranges`` the more specific entry wins
- **include_ranges**: Sequence of String - Include this list of ranges, meaning that dynamic rules will be inserted for clients in that range. When used in combination with ``exclude_ranges`` the more specific entry wins
- **exclude_domains**: Sequence of String - Exclude this list of domains, meaning that no dynamic rules will ever be inserted for this domain via ``suffix-match`` or ``suffix-match-ffi`` rules. Default to empty, meaning rules are applied to all domains
- **rules**: Sequence of :ref:`DynamicRuleConfiguration <yaml-settings-DynamicRuleConfiguration>` - List of dynamic rules in this group


.. _yaml-settings-Dynamic_rules_settingsConfiguration:

Dynamic_rules_settingsConfiguration
-----------------------------------

Dynamic rules-related settings

- **purge_interval**: Unsigned integer ``(60)`` - Set at which interval, in seconds, the expired dynamic blocks entries will be effectively removed from the tree. Entries are not applied anymore as soon as they expire, but they remain in the tree for a while for performance reasons. Removing them makes the addition of new entries faster and frees up the memory they use. Setting this value to 0 disables the purging mechanism, so entries will remain in the tree
- **default_action**: String ``(Drop)`` - Set which action is performed when a query is blocked. Supported values are: Drop, NoOp, NoRecurse, NXDomain, Refused, Truncate


.. _yaml-settings-EbpfConfiguration:

EbpfConfiguration
-----------------

``eBPF`` and ``XDP`` related settings

- **ipv4**: :ref:`EbpfMapConfiguration <yaml-settings-EbpfMapConfiguration>` - IPv4 maps
- **ipv6**: :ref:`EbpfMapConfiguration <yaml-settings-EbpfMapConfiguration>` - IPv6 maps
- **cidr_ipv4**: :ref:`EbpfMapConfiguration <yaml-settings-EbpfMapConfiguration>` - IPv4 subnets maps
- **cidr_ipv6**: :ref:`EbpfMapConfiguration <yaml-settings-EbpfMapConfiguration>` - IPv6 subnets maps
- **qnames**: :ref:`EbpfMapConfiguration <yaml-settings-EbpfMapConfiguration>` - DNS names maps
- **external**: Boolean ``(false)`` - If set to true, :program:`dnsdist` does not load the internal ``eBPF`` program. This is useful for ``AF_XDP`` and ``XDP`` maps


.. _yaml-settings-Ebpf_mapConfiguration:

Ebpf_mapConfiguration
---------------------

An ``eBPF`` map that is used to share data with kernel-land ``AF_XDP``/``XSK``, ``socket filter`` or ``XDP`` programs. Maps can be pinned to a filesystem path, which makes their content persistent across restarts and allows external programs to read their content and to add new entries. :program:`dnsdist` will try to load maps that are pinned to a filesystem path on startups, inheriting any existing entries, and fall back to creating them if they do not exist yet. Note that the user :program`dnsdist` is running under must have the right privileges to read and write to the given file, and to go through all the directories in the path leading to that file. The pinned path must be on a filesystem of type ``BPF``, usually below ``/sys/fs/bpf/``

- **max_entries**: Unsigned integer ``(0)`` - Maximum number of entries in this map. 0 means no entry at all
- **pinned_path**: String ``("")`` - The filesystem path this map should be pinned to


.. _yaml-settings-Edns_client_subnetConfiguration:

Edns_client_subnetConfiguration
-------------------------------

EDNS Client Subnet-related settings

- **override_existing**: Boolean ``(false)`` - When ``useClientSubnet`` in :func:`newServer()` or ``use_client_subnet`` in :ref:`_yaml-settings-BackendConfiguration` are set, and :program:`dnsdist` adds an EDNS Client Subnet Client option to the query, override an existing option already present in the query, if any. Please see Passing the source address to the backend for more information. Note that it’s not recommended to enable this option in front of an authoritative server responding with EDNS Client Subnet information as mismatching data (ECS scopes) can confuse clients and lead to SERVFAIL responses on downstream nameservers
- **source_prefix_v4**: Unsigned integer ``(32)`` - When ``useClientSubnet`` in :func:`newServer()` or ``use_client_subnet`` in :ref:`_yaml-settings-BackendConfiguration` are set, and :program:`dnsdist` adds an EDNS Client Subnet Client option to the query, truncate the requestor's IPv4 address to this number of bits
- **source_prefix_v6**: Unsigned integer ``(56)`` - When ``useClientSubnet`` in :func:`newServer()` or ``use_client_subnet`` in :ref:`_yaml-settings-BackendConfiguration` are set, and :program:`dnsdist` adds an EDNS Client Subnet Client option to the query, truncate the requestor's IPv6 address to this number of bits


.. _yaml-settings-GeneralConfiguration:

GeneralConfiguration
--------------------

- **edns_udp_payload_size_self_generated_answers**: Unsigned integer ``(1232)``
- **add_edns_to_self_generated_answers**: Boolean ``(true)``
- **truncate_tc_answers**: Boolean ``(false)``
- **fixup_case**: Boolean ``(false)``
- **verbose**: Boolean ``(false)``
- **verbose_health_checks**: Boolean ``(false)``
- **allow_empty_responses**: Boolean ``(false)``
- **drop_empty_queries**: Boolean ``(false)``
- **capabilities_to_retain**: Sequence of String


.. _yaml-settings-Health_checkConfiguration:

Health_checkConfiguration
-------------------------

- **mode**: String ``(auto)``
- **qname**: String ``("")``
- **qclass**: String ``(IN)``
- **qtype**: String ``(A)``
- **function**: String ``("")``
- **lua**: String ``("")``
- **lua_file**: String ``("")``
- **timeout**: Unsigned integer ``(1000)``
- **set_cd**: Boolean ``(false)``
- **max_failures**: Unsigned integer ``(1)``
- **rise**: Unsigned integer ``(1)``
- **interval**: Unsigned integer ``(1)``
- **must_resolve**: Boolean ``(false)``
- **use_tcp**: Boolean ``(false)``
- **lazy**: :ref:`LazyHealthCheckConfiguration <yaml-settings-LazyHealthCheckConfiguration>`


.. _yaml-settings-Http_custom_response_headerConfiguration:

Http_custom_response_headerConfiguration
----------------------------------------

- **key**: String
- **value**: String


.. _yaml-settings-Http_responses_mapConfiguration:

Http_responses_mapConfiguration
-------------------------------

- **expression**: String
- **status**: Unsigned integer
- **content**: String
- **headers**: Sequence of :ref:`HttpCustomResponseHeaderConfiguration <yaml-settings-HttpCustomResponseHeaderConfiguration>`


.. _yaml-settings-Incoming_dnscryptConfiguration:

Incoming_dnscryptConfiguration
------------------------------

- **provider_name**: String ``("")``
- **certificates**: Sequence of :ref:`IncomingDnscryptCertificateKeyPairConfiguration <yaml-settings-IncomingDnscryptCertificateKeyPairConfiguration>`


.. _yaml-settings-Incoming_dnscrypt_certificate_key_pairConfiguration:

Incoming_dnscrypt_certificate_key_pairConfiguration
---------------------------------------------------

- **certificate**: String
- **key**: String


.. _yaml-settings-Incoming_dohConfiguration:

Incoming_dohConfiguration
-------------------------

- **provider**: String ``(nghttp2)``
- **paths**: Sequence of String ``(/dns-query)``
- **idle_timeout**: Unsigned integer ``(30)``
- **server_tokens**: String ``(h2o/dnsdist)``
- **send_cache_control_headers**: Boolean ``(true)``
- **keep_incoming_headers**: Boolean ``(false)``
- **trust_forwarded_for_header**: Boolean ``(false)``
- **early_acl_drop**: Boolean ``(true)``
- **exact_path_matching**: Boolean ``(true)``
- **internal_pipe_buffer_size**: Unsigned integer ``(1048576)``
- **custom_response_headers**: Sequence of :ref:`HttpCustomResponseHeaderConfiguration <yaml-settings-HttpCustomResponseHeaderConfiguration>`
- **responses_map**: Sequence of :ref:`HttpResponsesMapConfiguration <yaml-settings-HttpResponsesMapConfiguration>`


.. _yaml-settings-Incoming_doqConfiguration:

Incoming_doqConfiguration
-------------------------

- **max_concurrent_queries_per_connection**: Unsigned integer ``(65535)``


.. _yaml-settings-Incoming_quicConfiguration:

Incoming_quicConfiguration
--------------------------

- **idle_timeout**: Unsigned integer ``(5)``
- **congestion_control_algorithm**: String ``(reno)``
- **internal_pipe_buffer_size**: Unsigned integer ``(1048576)``


.. _yaml-settings-Incoming_tcpConfiguration:

Incoming_tcpConfiguration
-------------------------

- **max_in_flight_queries**: Unsigned integer ``(0)``
- **listen_queue_size**: Unsigned integer ``(0)``
- **fast_open_queue_size**: Unsigned integer ``(0)``
- **max_concurrent_connections**: Unsigned integer ``(0)``


.. _yaml-settings-Incoming_tlsConfiguration:

Incoming_tlsConfiguration
-------------------------

TLS parameters for frontends

- **provider**: String ``(OpenSSL)`` - . Supported values are: OpenSSL, GnuTLS
- **certificates**: Sequence of :ref:`IncomingTlsCertificateKeyPairConfiguration <yaml-settings-IncomingTlsCertificateKeyPairConfiguration>`
- **ignore_errors**: Boolean ``(false)``
- **ciphers**: String ``("")``
- **ciphers_tls_13**: String ``("")``
- **minimum_version**: String ``(tls1.0)``
- **ticket_key_file**: String ``("")``
- **tickets_keys_rotation_delay**: Unsigned integer ``(43200)``
- **number_of_tickets_keys**: Unsigned integer ``(5)``
- **prefer_server_ciphers**: Boolean ``(true)``
- **session_timeout**: Unsigned integer ``(0)``
- **session_tickets**: Boolean ``(true)``
- **number_of_stored_sessions**: Unsigned integer ``(20480)``
- **ocsp_response_files**: Sequence of String
- **key_log_file**: String ``("")``
- **release_buffers**: Boolean ``(true)``
- **enable_renegotiation**: Boolean ``(false)``
- **async_mode**: Boolean ``(false)``
- **ktls**: Boolean ``(false)``
- **read_ahead**: Boolean ``(true)``
- **proxy_protocol_outside_tls**: Boolean ``(false)``
- **ignore_configuration_errors**: Boolean ``(false)``


.. _yaml-settings-Incoming_tls_certificate_key_pairConfiguration:

Incoming_tls_certificate_key_pairConfiguration
----------------------------------------------

A pair of TLS certificate and key, with an optional associated password

- **certificate**: String - A path to a file containing the certificate, in ``PEM``, ``DER`` or ``PKCS12`` format
- **key**: String ``("")`` - A path to a file containing the key corresponding to the certificate, in ``PEM``, ``DER`` or ``PKCS12`` format
- **password**: String ``("")`` - Password protecting the PKCS12 file if appropriate


.. _yaml-settings-KVSLookupKeyQNameConfiguration:

KVSLookupKeyQNameConfiguration
------------------------------

Lookup key that can be used with :ref:`_yaml-settings-KeyValueStoreLookupAction` or :ref:`_yaml-settings-KeyValueStoreLookupSelector`, will return the qname of the query in DNS wire format

- **name**: String - The name of this lookup key
- **wire_format**: Boolean ``(true)`` - Whether to do the lookup in wire format (default) or in plain text


.. _yaml-settings-KVSLookupKeySourceIPConfiguration:

KVSLookupKeySourceIPConfiguration
---------------------------------

Lookup key that can be used with :ref:`_yaml-settings-KeyValueStoreLookupAction` or :ref:`_yaml-settings-KeyValueStoreLookupSelector`, will return the source IP of the client in network byte-order

- **name**: String - The name of this lookup key
- **v4_mask**: Unsigned integer ``(32)`` - Mask applied to IPv4 addresses. Default is 32 (the whole address)
- **v6_mask**: Unsigned integer ``(128)`` - Mask applied to IPv6 addresses. Default is 128 (the whole address)
- **include_port**: Boolean ``(false)`` - Whether to append the port (in network byte-order) after the address


.. _yaml-settings-KVSLookupKeySuffixConfiguration:

KVSLookupKeySuffixConfiguration
-------------------------------

Lookup key that can be used with :ref:`_yaml-settings-KeyValueStoreLookupAction` or :ref:`_yaml-settings-KeyValueStoreLookupSelector`, will return a vector of keys based on the labels of the qname in DNS wire format or plain text. For example if the qname is sub.domain.powerdns.com. the following keys will be returned:

- ``\\3sub\\6domain\\8powerdns\\3com\\0``
- ``\\6domain\\8powerdns\\3com\\0``
- ``\\8powerdns\\3com\\0``
- ``\\3com\\0``
- ``\\0``

If ``min_labels`` is set to a value larger than ``0`` the lookup will only be done as long as there is at least ``min_labels`` labels remaining. Taking back our previous example, it means only the following keys will be returned if ``min_labels`` is set to ``2``:

- ``\\3sub\\6domain\\8powerdns\\3com\\0``
- ``\\6domain\\8powerdns\\3com\\0``
- ``\\8powerdns\\3com\\0``


- **name**: String - The name of this lookup key
- **minimum_labels**: Unsigned integer ``(0)`` - The minimum number of labels to do a lookup for. Default is 0 which means unlimited
- **wire_format**: Boolean ``(true)`` - Whether to do the lookup in wire format (default) or in plain text


.. _yaml-settings-KVSLookupKeyTagConfiguration:

KVSLookupKeyTagConfiguration
----------------------------

Lookup key that can be used with :ref:`_yaml-settings-KeyValueStoreLookupAction` or :ref:`_yaml-settings-KeyValueStoreLookupSelector`, will return the value of the corresponding tag for this query, if it exists

- **name**: String
- **tag**: String


.. _yaml-settings-KVSLookupKeysConfiguration:

KVSLookupKeysConfiguration
--------------------------

List of look keys that can be used with :ref:`_yaml-settings-KeyValueStoreLookupAction` or :ref:`_yaml-settings-KeyValueStoreLookupSelector`

- **source_ip_keys**: Sequence of :ref:`KVSLookupKeySourceIPConfiguration <yaml-settings-KVSLookupKeySourceIPConfiguration>`
- **qname_keys**: Sequence of :ref:`KVSLookupKeyQNameConfiguration <yaml-settings-KVSLookupKeyQNameConfiguration>`
- **suffix_keys**: Sequence of :ref:`KVSLookupKeySuffixConfiguration <yaml-settings-KVSLookupKeySuffixConfiguration>`
- **tag_keys**: Sequence of :ref:`KVSLookupKeyTagConfiguration <yaml-settings-KVSLookupKeyTagConfiguration>`


.. _yaml-settings-Key_value_storesConfiguration:

Key_value_storesConfiguration
-----------------------------

List of key-value stores that can be used with :ref:`_yaml-settings-KeyValueStoreLookupAction` or :ref:`_yaml-settings-KeyValueStoreLookupSelector`

- **lmdb**: Sequence of :ref:`LMDBKVStoreConfiguration <yaml-settings-LMDBKVStoreConfiguration>` - List of LMDB-based key-value stores
- **cdb**: Sequence of :ref:`CDBKVStoreConfiguration <yaml-settings-CDBKVStoreConfiguration>` - List of CDB-based key-value stores
- **lookup_keys**: :ref:`KVSLookupKeysConfiguration <yaml-settings-KVSLookupKeysConfiguration>` - List of lookup keys


.. _yaml-settings-LMDBKVStoreConfiguration:

LMDBKVStoreConfiguration
------------------------

LMDB-based key-value store

- **name**: String - The name of this object
- **file_name**: String - The path to an existing ``LMDB`` database created with ``MDB_NOSUBDIR``
- **database_name**: String - The name of the database to use
- **no_lock**: Boolean ``(false)`` - Whether to open the database with the ``MDB_NOLOCK`` flag


.. _yaml-settings-Lazy_health_checkConfiguration:

Lazy_health_checkConfiguration
------------------------------

- **interval**: Unsigned integer ``(30)``
- **min_sample_count**: Unsigned integer ``(1)``
- **mode**: String ``(TimeoutOrServFail)``
- **sample_size**: Unsigned integer ``(100)``
- **threshold**: Unsigned integer ``(20)``
- **use_exponential_back_off**: Boolean ``(false)``
- **max_back_off**: Unsigned integer ``(3600)``


.. _yaml-settings-Load_balancing_policiesConfiguration:

Load_balancing_policiesConfiguration
------------------------------------

- **default_policy**: String ``(leastOutstanding)``
- **servfail_on_no_server**: Boolean ``(false)``
- **round_robin_servfail_on_no_server**: Boolean ``(false)``
- **weighted_balancing_factor**: Double ``(0.0)``
- **consistent_hashing_balancing_factor**: Double ``(0.0)``
- **custom_policies**: Sequence of :ref:`CustomLoadBalancingPolicyConfiguration <yaml-settings-CustomLoadBalancingPolicyConfiguration>`
- **hash_perturbation**: Unsigned integer ``(0)``


.. _yaml-settings-MetricsConfiguration:

MetricsConfiguration
--------------------

Metrics-related settings

- **carbon**: Sequence of :ref:`CarbonConfiguration <yaml-settings-CarbonConfiguration>` - List of Carbon endpoints to send metrics to


.. _yaml-settings-Outgoing_auto_upgradeConfiguration:

Outgoing_auto_upgradeConfiguration
----------------------------------

- **enabled**: Boolean ``(false)``
- **interval**: Unsigned integer ``(3600)``
- **keep**: Boolean ``(false)``
- **pool**: String ``("")``
- **doh_key**: Unsigned integer ``(7)``
- **use_lazy_health_check**: Boolean ``(false)``


.. _yaml-settings-Outgoing_dohConfiguration:

Outgoing_dohConfiguration
-------------------------

- **path**: String ``(/dns-query)``
- **add_x_forwarded_headers**: Boolean ``(false)``


.. _yaml-settings-Outgoing_tcpConfiguration:

Outgoing_tcpConfiguration
-------------------------

- **connect_timeout**: Unsigned integer ``(5)``
- **send_timeout**: Unsigned integer ``(30)``
- **receive_timeout**: Unsigned integer ``(30)``
- **fast_open**: Boolean ``(false)``


.. _yaml-settings-Outgoing_tlsConfiguration:

Outgoing_tlsConfiguration
-------------------------

- **provider**: String ``(OpenSSL)``
- **subject_name**: String ``("")``
- **subject_address**: String ``("")``
- **validate_certificate**: Boolean ``(true)``
- **ca_store**: String ``("")``
- **ciphers**: String ``("")``
- **ciphers_tls_13**: String ``("")``
- **key_log_file**: String ``("")``
- **release_buffers**: Boolean ``(true)``
- **enable_renegotiation**: Boolean ``(false)``
- **ktls**: Boolean ``(false)``


.. _yaml-settings-Packet_cacheConfiguration:

Packet_cacheConfiguration
-------------------------

- **name**: String
- **size**: Unsigned integer
- **deferrable_insert_lock**: Boolean ``(true)``
- **dont_age**: Boolean ``(false)``
- **keep_stale_data**: Boolean ``(false)``
- **max_negative_ttl**: Unsigned integer ``(3600)``
- **max_ttl**: Unsigned integer ``(86400)``
- **min_ttl**: Unsigned integer ``(0)``
- **shards**: Unsigned integer ``(20)``
- **parse_ecs**: Boolean ``(false)``
- **stale_ttl**: Unsigned integer ``(60)``
- **temporary_failure_ttl**: Unsigned integer ``(60)``
- **cookie_hashing**: Boolean ``(false)``
- **maximum_entry_size**: Unsigned integer ``(0)``
- **options_to_skip**: Sequence of String


.. _yaml-settings-PoolConfiguration:

PoolConfiguration
-----------------

- **name**: String
- **packet_cache**: String
- **policy**: String ``(leastOutstanding)``


.. _yaml-settings-ProtoBufMetaConfiguration:

ProtoBufMetaConfiguration
-------------------------

Meta-data entry to be added to a Protocol Buffer message

- **key**: String - Name of the meta entry
- **value**: String - Value of the meta entry


.. _yaml-settings-Protobuf_loggerConfiguration:

Protobuf_loggerConfiguration
----------------------------

Endpoint to send queries and/or responses data to, using the native PowerDNS format

- **name**: String - Name of this endpoint
- **address**: String - An IP:PORT combination where the logger is listening
- **timeout**: Unsigned integer ``(2)`` - TCP connect timeout in seconds
- **max_queued_entries**: Unsigned integer ``(100)`` - Queue this many messages before dropping new ones (e.g. when the remote listener closes the connection)
- **reconnect_wait_time**: Unsigned integer ``(1)`` - Time in seconds between reconnection attempts


.. _yaml-settings-Proxy_protocolConfiguration:

Proxy_protocolConfiguration
---------------------------

- **acl**: Sequence of String ``("")``
- **maximum_payload_size**: Unsigned integer ``(512)``
- **apply_acl_to_proxied_clients**: Boolean ``(false)``


.. _yaml-settings-Proxy_protocol_valueConfiguration:

Proxy_protocol_valueConfiguration
---------------------------------

- **key**: Unsigned integer
- **value**: String


.. _yaml-settings-Query_countConfiguration:

Query_countConfiguration
------------------------

- **enabled**: Boolean ``(false)``
- **filter_function_name**: String ``("")``
- **filter_function_code**: String ``("")``
- **filter_function_file**: String ``("")``


.. _yaml-settings-Query_ruleConfiguration:

Query_ruleConfiguration
-----------------------

- **name**: String
- **uuid**: String
- **selector**: :ref:`Selector <yaml-settings-Selector>`
- **action**: :ref:`Action <yaml-settings-Action>`


.. _yaml-settings-Remote_loggingConfiguration:

Remote_loggingConfiguration
---------------------------

Queries and/or responses remote logging settings

- **protobuf_loggers**: Sequence of :ref:`ProtobufLoggerConfiguration <yaml-settings-ProtobufLoggerConfiguration>` - List of endpoints to send queries and/or responses data to, using the native PowerDNS format
- **dnstap_loggers**: Sequence of :ref:`DnstapLoggerConfiguration <yaml-settings-DnstapLoggerConfiguration>` - List of endpoints to send queries and/or responses data to, using the dnstap format


.. _yaml-settings-Response_ruleConfiguration:

Response_ruleConfiguration
--------------------------

- **name**: String
- **uuid**: String
- **selector**: :ref:`Selector <yaml-settings-Selector>`
- **action**: :ref:`ResponseAction <yaml-settings-ResponseAction>`


.. _yaml-settings-Ring_buffersConfiguration:

Ring_buffersConfiguration
-------------------------

Settings for in-memory ring buffers, that are used for live traffic inspection and dynamic rules

- **size**: Unsigned integer ``(10000)`` - The maximum amount of queries to keep in the ringbuffer
- **shards**: Unsigned integer ``(10)`` - The number of shards to use to limit lock contention
- **lock_retries**: Unsigned integer ``(5)`` - Set the number of shards to attempt to lock without blocking before giving up and simply blocking while waiting for the next shard to be available. Default to 5 if there is more than one shard, 0 otherwise
- **record_queries**: Boolean ``(true)`` - Whether to record queries in the ring buffers
- **record_responses**: Boolean ``(true)`` - Whether to record responses in the ring buffers


.. _yaml-settings-Security_pollingConfiguration:

Security_pollingConfiguration
-----------------------------

- **polling_interval**: Unsigned integer ``(3600)``
- **suffix**: String ``(secpoll.powerdns.com.)``


.. _yaml-settings-SnmpConfiguration:

SnmpConfiguration
-----------------

- **enabled**: Boolean ``(false)``
- **traps_enabled**: Boolean ``(false)``
- **daemon_socket**: String ``("")``


.. _yaml-settings-Tcp_tuningConfiguration:

Tcp_tuningConfiguration
-----------------------

- **worker_threads**: Unsigned integer ``(10)``
- **receive_timeout**: Unsigned integer ``(2)``
- **send_timeout**: Unsigned integer ``(2)``
- **max_queries_per_connection**: Unsigned integer ``(0)``
- **max_connection_duration**: Unsigned integer ``(0)``
- **max_queued_connections**: Unsigned integer ``(10000)``
- **internal_pipe_buffer_size**: Unsigned integer ``(1048576)``
- **outgoing_max_idle_time**: Unsigned integer ``(300)``
- **outgoing_cleanup_interval**: Unsigned integer ``(60)``
- **outgoing_max_idle_connection_per_backend**: Unsigned integer ``(10)``
- **max_connections_per_client**: Unsigned integer ``(0)``
- **fast_open_key**: String ``("")``


.. _yaml-settings-Tls_tuningConfiguration:

Tls_tuningConfiguration
-----------------------

- **outgoing_tickets_cache_cleanup_delay**: Unsigned integer ``(60)``
- **outgoing_tickets_cache_validity**: Unsigned integer ``(600)``
- **max_outgoing_tickets_per_backend**: Unsigned integer ``(20)``


.. _yaml-settings-TuningConfiguration:

TuningConfiguration
-------------------

- **doh**: :ref:`DohTuningConfiguration <yaml-settings-DohTuningConfiguration>`
- **tcp**: :ref:`TcpTuningConfiguration <yaml-settings-TcpTuningConfiguration>`
- **tls**: :ref:`TlsTuningConfiguration <yaml-settings-TlsTuningConfiguration>`
- **udp**: :ref:`UdpTuningConfiguration <yaml-settings-UdpTuningConfiguration>`


.. _yaml-settings-Udp_tuningConfiguration:

Udp_tuningConfiguration
-----------------------

- **messages_per_round**: Unsigned integer ``(1)``
- **send_buffer_size**: Unsigned integer ``(0)``
- **receive_buffer_size**: Unsigned integer ``(0)``
- **max_outstanding_per_backend**: Unsigned integer ``(65535)``
- **timeout**: Unsigned integer ``(2)``
- **randomize_outgoing_sockets_to_backend**: Boolean ``(false)``
- **randomize_ids_to_backend**: Boolean ``(false)``


.. _yaml-settings-WebserverConfiguration:

WebserverConfiguration
----------------------

- **listen_address**: String ``("")`` - IP address and port to listen on
- **password**: String ``("")`` - The password used to access the internal webserver. Since 1.7.0 the password should be hashed and salted via the ``hashPassword()`` command
- **api_key**: String ``("")`` - The API Key (set to an empty string do disable it). Since 1.7.0 the key should be hashed and salted via the ``hashPassword()`` command
- **acl**: Sequence of String ``(127.0.0.1, ::1)`` - List of network masks or IP addresses that are allowed to open a connection to the web server
- **api_requires_authentication**: Boolean ``(true)`` - Whether access to the API (/api endpoints) requires a valid API key
- **stats_require_authentication**: Boolean ``(true)`` - Whether access to the statistics (/metrics and /jsonstat endpoints) requires a valid password or API key
- **dashboard_requires_authentication**: Boolean ``(true)`` - Whether access to the internal dashboard requires a valid password
- **max_concurrent_connections**: Unsigned integer ``(100)`` - The maximum number of concurrent web connections, or 0 which means an unlimited number
- **hash_plaintext_credentials**: Boolean ``(false)`` - Whether passwords and API keys provided in plaintext should be hashed during startup, to prevent the plaintext versions from staying in memory. Doing so increases significantly the cost of verifying credentials
- **custom_headers**: Sequence of :ref:`HttpCustomResponseHeaderConfiguration <yaml-settings-HttpCustomResponseHeaderConfiguration>` - List of custom HTTP headers to set in our responses
- **api_configuration_directory**: String ``("")`` - A valid directory where the configuration files will be written by the API
- **api_read_write**: Boolean ``(false)`` - Allow modifications via the API. Optionally saving these changes to disk. Modifications done via the API will not be written to the configuration by default and will not persist after a reload


.. _yaml-settings-XskConfiguration:

XskConfiguration
----------------

- **name**: String
- **interface**: String
- **queues**: Unsigned integer
- **frames**: Unsigned integer ``(65536)``
- **map_path**: String ``(/sys/fs/bpf/dnsdist/xskmap)``


